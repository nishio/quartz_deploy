<!DOCTYPE html>
<html lang="en"><head><title>Hatena2009-07-23</title><meta charset="utf-8"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com"/><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=IBM Plex Mono&amp;family=Schibsted Grotesk:wght@400;700&amp;family=Source Sans Pro:ital,wght@0,400;0,600;1,400;1,600&amp;display=swap"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="og:site_name" content="🪴 Quartz 4.0"/><meta property="og:title" content="Hatena2009-07-23"/><meta property="og:type" content="website"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="Hatena2009-07-23"/><meta name="twitter:description" content="hatena &lt;body> *1248330993*Diary The question is whether to make it quickly with the existing library or to make it after solidifying the footing with boost::gil ..."/><meta property="og:description" content="hatena &lt;body> *1248330993*Diary The question is whether to make it quickly with the existing library or to make it after solidifying the footing with boost::gil ..."/><meta property="og:image:type" content="image/webp"/><meta property="og:image:alt" content="hatena &lt;body> *1248330993*Diary The question is whether to make it quickly with the existing library or to make it after solidifying the footing with boost::gil ..."/><meta property="og:image:width" content="1200"/><meta property="og:image:height" content="630"/><meta property="og:width" content="1200"/><meta property="og:height" content="630"/><meta property="og:image:url" content="https://quartz.jzhao.xyz/static/og-image.png"/><meta name="twitter:image" content="https://quartz.jzhao.xyz/static/og-image.png"/><meta property="og:image" content="https://quartz.jzhao.xyz/static/og-image.png"/><meta property="twitter:domain" content="quartz.jzhao.xyz"/><meta property="og:url" content="https:/quartz.jzhao.xyz/Hatena2009-07-23"/><meta property="twitter:url" content="https:/quartz.jzhao.xyz/Hatena2009-07-23"/><link rel="icon" href="./static/icon.png"/><meta name="description" content="hatena &lt;body> *1248330993*Diary The question is whether to make it quickly with the existing library or to make it after solidifying the footing with boost::gil ..."/><meta name="generator" content="Quartz"/><link href="./index.css" rel="stylesheet" type="text/css" spa-preserve/><link href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" rel="stylesheet" type="text/css" spa-preserve/><script src="./prescript.js" type="application/javascript" spa-preserve></script><script type="application/javascript" spa-preserve>const fetchData = fetch("./static/contentIndex.json").then(data => data.json())</script></head><body data-slug="Hatena2009-07-23"><div id="quartz-root" class="page"><div id="quartz-body"><div class="left sidebar"><h2 class="page-title"><a href=".">🪴 Quartz 4.0</a></h2><div class="spacer mobile-only"></div><div class="search"><button class="search-button" id="search-button"><p>Search</p><svg role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title>Search</title><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"></path><circle cx="8" cy="8" r="7"></circle></g></svg></button><div id="search-container"><div id="search-space"><input autocomplete="off" id="search-bar" name="search" type="text" aria-label="Search for something" placeholder="Search for something"/><div id="search-layout" data-preview="true"></div></div></div></div><button class="darkmode" id="darkmode"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="dayIcon" x="0px" y="0px" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35" xml:space="preserve" aria-label="Dark mode"><title>Dark mode</title><path d="M6,17.5C6,16.672,5.328,16,4.5,16h-3C0.672,16,0,16.672,0,17.5    S0.672,19,1.5,19h3C5.328,19,6,18.328,6,17.5z M7.5,26c-0.414,0-0.789,0.168-1.061,0.439l-2,2C4.168,28.711,4,29.086,4,29.5    C4,30.328,4.671,31,5.5,31c0.414,0,0.789-0.168,1.06-0.44l2-2C8.832,28.289,9,27.914,9,27.5C9,26.672,8.329,26,7.5,26z M17.5,6    C18.329,6,19,5.328,19,4.5v-3C19,0.672,18.329,0,17.5,0S16,0.672,16,1.5v3C16,5.328,16.671,6,17.5,6z M27.5,9    c0.414,0,0.789-0.168,1.06-0.439l2-2C30.832,6.289,31,5.914,31,5.5C31,4.672,30.329,4,29.5,4c-0.414,0-0.789,0.168-1.061,0.44    l-2,2C26.168,6.711,26,7.086,26,7.5C26,8.328,26.671,9,27.5,9z M6.439,8.561C6.711,8.832,7.086,9,7.5,9C8.328,9,9,8.328,9,7.5    c0-0.414-0.168-0.789-0.439-1.061l-2-2C6.289,4.168,5.914,4,5.5,4C4.672,4,4,4.672,4,5.5c0,0.414,0.168,0.789,0.439,1.06    L6.439,8.561z M33.5,16h-3c-0.828,0-1.5,0.672-1.5,1.5s0.672,1.5,1.5,1.5h3c0.828,0,1.5-0.672,1.5-1.5S34.328,16,33.5,16z     M28.561,26.439C28.289,26.168,27.914,26,27.5,26c-0.828,0-1.5,0.672-1.5,1.5c0,0.414,0.168,0.789,0.439,1.06l2,2    C28.711,30.832,29.086,31,29.5,31c0.828,0,1.5-0.672,1.5-1.5c0-0.414-0.168-0.789-0.439-1.061L28.561,26.439z M17.5,29    c-0.829,0-1.5,0.672-1.5,1.5v3c0,0.828,0.671,1.5,1.5,1.5s1.5-0.672,1.5-1.5v-3C19,29.672,18.329,29,17.5,29z M17.5,7    C11.71,7,7,11.71,7,17.5S11.71,28,17.5,28S28,23.29,28,17.5S23.29,7,17.5,7z M17.5,25c-4.136,0-7.5-3.364-7.5-7.5    c0-4.136,3.364-7.5,7.5-7.5c4.136,0,7.5,3.364,7.5,7.5C25,21.636,21.636,25,17.5,25z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="nightIcon" x="0px" y="0px" viewBox="0 0 100 100" style="enable-background:new 0 0 100 100" xml:space="preserve" aria-label="Light mode"><title>Light mode</title><path d="M96.76,66.458c-0.853-0.852-2.15-1.064-3.23-0.534c-6.063,2.991-12.858,4.571-19.655,4.571  C62.022,70.495,50.88,65.88,42.5,57.5C29.043,44.043,25.658,23.536,34.076,6.47c0.532-1.08,0.318-2.379-0.534-3.23  c-0.851-0.852-2.15-1.064-3.23-0.534c-4.918,2.427-9.375,5.619-13.246,9.491c-9.447,9.447-14.65,22.008-14.65,35.369  c0,13.36,5.203,25.921,14.65,35.368s22.008,14.65,35.368,14.65c13.361,0,25.921-5.203,35.369-14.65  c3.872-3.871,7.064-8.328,9.491-13.246C97.826,68.608,97.611,67.309,96.76,66.458z"></path></svg></button></div><div class="center"><div class="page-header"><div class="popover-hint"><nav class="breadcrumb-container" aria-label="breadcrumbs"><div class="breadcrumb-element"><a href="./">Home</a><p> ❯ </p></div><div class="breadcrumb-element"><a href>Hatena2009-07-23</a></div></nav><h1 class="article-title">Hatena2009-07-23</h1><p show-comma="true" class="content-meta"><span>Jul 23, 2009</span><span>8 min read</span></p></div></div><article class="popover-hint"><p>hatena</p>
<pre><code>&lt;body>
*1248330993*Diary
The question is whether to make it quickly with the existing library or to make it after solidifying the footing with boost::gil. I'm going to make it with my existing libraries. (Oh!

&lt;hr>

I stepped on the catsuit part of the sun visor and broke it and it keeps slipping off my head. Maybe I should buy a new one. The problem is that I can't wear a sun visor and muffled headphones at the same time, so I might as well combine the sun visor and headphones!

And where are those muffled headphones?

&lt;hr>

I bought my first paid app for my iPhone, Spore Origin, and got stuck on stage 8 with lots of spiky stuff. After dying many times, I put on the scales and eyeballs and played carefully. I thought I couldn't erase the parts once I put them on, but it seems I can erase and put them back on as many times as I want.

f:id:nishiohirokazu:20090724030338j:image

*1248337194* How to make coffee cola
trick
- 1: The ratio of cola to coffee should be more cola than coffee, otherwise the cola will be overwhelmed by the coffee and the taste will be very subtle.
- 2: To reduce the amount of liquid in the coffee, make the coffee super thick. It's like pouring an inch of hot water over the normal amount of instant coffee.
- 3: If you pour cola directly into very strong coffee, a lot of fine bubbles will form and it will be chaotic, so pour it into another container before pouring it in.


The &lt;a href=&quot;http://www.woopie.jp/video/watch/c2fcb187a34283be&quot;>commercial&lt;/a> clearly looks like they are heating the cola, but I think cola tastes worse when heated.

*1248352552*Painting of the Day
What's this shift?
&lt;img src=&quot;http://gyazo.com/ecb537ce45537587d6cdd1c8eaeb1253.png&quot;>

It's shifting more and more as I get closer. Is this a distance-dependent bug?
&lt;img src=&quot;http://gyazo.com/bcb2236af6889aaad926462243d72e8a.png&quot;>

Just to be sure, look at it 10 times further away with the angle unchanged to isolate whether it depends on the distance or the elevation angle.
&lt;img src=&quot;http://gyazo.com/f4abdc7032452320f712e8a23b66172c.png&quot;>

Much more double.
&lt;img src=&quot;http://gyazo.com/d653cbf12d3080146a84d2f3278a54c4.png&quot;>

It's not distance, this is not distance. It's a bug where the angle of elevation is so steep that the illumination is outward from the actual situation.

Try to make the angle steeper.
&lt;img src=&quot;http://gyazo.com/8611fa9708ac4d7af5c83d4585ddc9ab.png&quot;>
The steeper the angle of elevation, the more the lighting shrinks w
No, I had a sneaking suspicion it was strange because when I looked up from below, it was smaller when it should have been larger (fix it then!).


Wow, the camera matrix is not normalized. The larger the elevation angle, the smaller the matrix. I thought I normalized it correctly.

Ai, okay.
>|cpp|
  camera_dir /= mag(camera_dir);
  camera_left = cross_prod(camera_dir, camera_up); 
  camera_up = -cross_prod(camera_dir, camera_left); 
||&lt;

The correct answer is.
>|cpp|
  camera_dir /= mag(camera_dir);
  camera_left = cross_prod(camera_dir, camera_up); 
  camera_left /= mag(camera_left);
  camera_up = -cross_prod(camera_dir, camera_left); 
||&lt;

Why do you think you have normalized only one of the three axes and think you have normalized all three axes?

Result. Oh, that's what happens. Each was off in the opposite direction? Well, that's right. It is strange that only one of the two matrices, ray tracing and projection, is shifted, even though they use the same matrix. I guess it means that the light direction is opposite, so they are shifted in the opposite direction.
&lt;img src=&quot;http://gyazo.com/d5b1ff550c4d53c7937bb93fa58777ba.png&quot;>

Zoom in. Ooh, that's moody.
&lt;img src=&quot;http://gyazo.com/f075078b911bcf37aaa4b9522b40c4d3.png&quot;>

I thought that rendering with hundreds of lights is called Global Illumination, but I was wrong. Global Illumination is a type of illumination in which the reflected light from a diffuse or specular reflective surface illuminates other objects. Mine is called DI (Direct Illumination).

*1248365438*[TopCoder]Single Round Match 445 Div2
It's been a very long time. I seem to have recovered a lot, probably because I've been playing with renderers and touching C++ for a while now. I have about 10 minutes left to respond, but I've submitted everything, so there's nothing to do (or prepare for a shoot down, which is what I would normally do).

I think I'll go to bed quickly, hoping I don't fail the test.
&lt;img src=&quot;http://gyazo.com/54819a7ed4eacc3e3696d39645bcebc4.png&quot;>

And while I'm at it, the coding phase is over. Let's write the code and explanation.

First is the 300-point problem. This is a question where you are given a string of letters a-z in the alphabet and asked to return the earliest of the conversion ciphers for it in lexicographic order. Just go through the given string from the beginning, and if there is a time when it has not yet been converted, replace it with the youngest letter.

I was angry because I reversed the argument of string result(N, '*');.
>|cpp|
  string encrypt(string message) {
    size_t N = message.size();
    string result(N, '*');
    char to = 'a';
    for(size_t i=0; i&lt;N; i++){
      if(result[i] == '*'){
	char frm = message[i];
	for(size_t j=i; j&lt;N; j++){
	  if(message[j] == frm){
	    result[j] = to;
	  }
	}
	to++;
      }
    }
    return result;
  }
||&lt;

500 point problem. Given some coordinates, the question is to answer how many points are there such that there is a point in the given coordinates to true north, true south, true west, and true east.

Since the coordinates are integers of -100..100, 200 * 200, you can try them all and still have 40000. You can try them all; it's still no big deal to check at most 50 given vertices every time for every 40000 points, but I came up with the flagging one first, so that's what I wrote.

I had initially used += instead of |=, so it did not pass the test.
>|cpp|
  int count(vector &lt;int> xs, vector &lt;int> ys) {
    vector&lt;int> map(40000);
    size_t N = xs.size();
    for(size_t i=0; i&lt;N; i++){
      size_t x = xs[i] + 100, y = ys[i] + 100; // map to 0..200
      for(size_t j = 0; j &lt; x; j++){
        map[j + y * 200] |= 1;
      }
      for(size_t j = x + 1; j &lt;= 200; j++){
        map[j + y * 200] |= 2;
      }
      for(size_t j = 0; j &lt; y; j++){
        map[x + j * 200] |= 4;
      }
      for(size_t j = y + 1; j &lt;= 200; j++){
        map[x + j * 200] |= 8;
      }
    }
    return std::count(map.begin(), map.end(), 15);
  }
||&lt;

A 1000 point problem, starting with an n-digit 0 and repeating until you either change some 0s to 1s or some 1s to 0s. You must not repeat the same number, and if there are multiple choices, you must choose the one with the smallest value. What is the kth digit?

I wrote down on paper when it was 3 and 4 digits and decided (wrongly) that it was only one digit that always changes, and when I implemented it, only the last one in the test case didn't pass. Oh, no.

After worrying about it for about 10 minutes, he realizes, &quot;When you change back from 1 to 0, it is not necessarily one. If a lot of them can be made smaller by putting them all together and making them 0, that is the one that will be chosen. So, when reducing the number of 1's, it is necessary to search for all the patterns to choose which of the already standing 1's to make 0. That's a lot of code.

Then I realize, &quot;So, the maximum number of digits is 10, which means that even if the maximum number of bits are standing, it should be 1024 streets. There is a lot of waste, but I decided not to worry about it.

>|cpp|
  string password(int n, int k) {
    int key = 0;
    vector&lt;int> used;
    used.push_back(key);
    for(int days=1; days &lt; k; days++){
      int minnext = 1024; 
      for(int i=0; i&lt;n; i++){
	int newkey = key ^ (1 &lt;&lt; i);
	if(newkey &lt; minnext){
	  if(find(used.begin(), used.end(), newkey) == used.end()){
	    minnext = newkey;
	  }
	}
      }
      for(size_t i=0; i&lt;1024; i++){
	int newkey = key &amp; i;
	if(newkey &lt; minnext){
	  if(find(used.begin(), used.end(), newkey) == used.end()){
	    minnext = newkey;
	  }
	}
      }
      key = minnext;
      used.push_back(key);
    }
    // int to string
    return int2str(key, n);
  }
||&lt;

This passed the test for all three questions for now, so I SUBMIT, and since I no longer had the energy to work hard, I just hung out in the chat room and chatted with people. The challenge phase ended when I wrote this entry so far. So far, I haven't been shot down. I hope it passes the system test.

&lt;hr>

Oops...failed 500 points. Mwah, haha, -100...if it was 100, it would be 201, not 200!
&lt;img src=&quot;http://gyazo.com/0ee75bb8cfc956779df8a84c2d145cfb.png&quot;>
&lt;/body>
&lt;comments>
&lt;comment>
&lt;username>Kazuaki Natsuhara&lt;/username>.
&lt;body>I followed you from mixi. &lt;br>Happy Birthday! &lt;br>I'm sorry&lt;/body>.
&lt;timestamp>1248345599&lt;/timestamp>
&lt;/comment>
&lt;/comments>
</code></pre>
<h2 id="hatena-diary-2009-07-23"><a href="https://nishiohirokazu.hatenadiary.org/archive/2009/07/23" class="external">Hatena Diary 2009-07-23<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#hatena-diary-2009-07-23" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>This page is auto-translated from <a href="https://scrapbox.io/nishio/Hatena2009-07-23" class="external">/nishio/Hatena2009-07-23<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a> using DeepL. If you looks something interesting but the auto-translated English is not good enough to understand it, feel free to let me know at <a href="https://twitter.com/nishio_en" class="external">@nishio_en<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a>. I’m very happy to spread my thought to non-Japanese readers.</p></article><hr/><div class="page-footer"></div></div><div class="right sidebar"><div class="graph"><h3>Graph View</h3><div class="graph-outer"><div id="graph-container" data-cfg="{&quot;drag&quot;:true,&quot;zoom&quot;:true,&quot;depth&quot;:1,&quot;scale&quot;:1.1,&quot;repelForce&quot;:0.5,&quot;centerForce&quot;:0.3,&quot;linkDistance&quot;:30,&quot;fontSize&quot;:0.6,&quot;opacityScale&quot;:1,&quot;showTags&quot;:true,&quot;removeTags&quot;:[],&quot;focusOnHover&quot;:false}"></div><button id="global-graph-icon" aria-label="Global Graph"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 55 55" fill="currentColor" xml:space="preserve"><path d="M49,0c-3.309,0-6,2.691-6,6c0,1.035,0.263,2.009,0.726,2.86l-9.829,9.829C32.542,17.634,30.846,17,29,17
                s-3.542,0.634-4.898,1.688l-7.669-7.669C16.785,10.424,17,9.74,17,9c0-2.206-1.794-4-4-4S9,6.794,9,9s1.794,4,4,4
                c0.74,0,1.424-0.215,2.019-0.567l7.669,7.669C21.634,21.458,21,23.154,21,25s0.634,3.542,1.688,4.897L10.024,42.562
                C8.958,41.595,7.549,41,6,41c-3.309,0-6,2.691-6,6s2.691,6,6,6s6-2.691,6-6c0-1.035-0.263-2.009-0.726-2.86l12.829-12.829
                c1.106,0.86,2.44,1.436,3.898,1.619v10.16c-2.833,0.478-5,2.942-5,5.91c0,3.309,2.691,6,6,6s6-2.691,6-6c0-2.967-2.167-5.431-5-5.91
                v-10.16c1.458-0.183,2.792-0.759,3.898-1.619l7.669,7.669C41.215,39.576,41,40.26,41,41c0,2.206,1.794,4,4,4s4-1.794,4-4
                s-1.794-4-4-4c-0.74,0-1.424,0.215-2.019,0.567l-7.669-7.669C36.366,28.542,37,26.846,37,25s-0.634-3.542-1.688-4.897l9.665-9.665
                C46.042,11.405,47.451,12,49,12c3.309,0,6-2.691,6-6S52.309,0,49,0z M11,9c0-1.103,0.897-2,2-2s2,0.897,2,2s-0.897,2-2,2
                S11,10.103,11,9z M6,51c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S8.206,51,6,51z M33,49c0,2.206-1.794,4-4,4s-4-1.794-4-4
                s1.794-4,4-4S33,46.794,33,49z M29,31c-3.309,0-6-2.691-6-6s2.691-6,6-6s6,2.691,6,6S32.309,31,29,31z M47,41c0,1.103-0.897,2-2,2
                s-2-0.897-2-2s0.897-2,2-2S47,39.897,47,41z M49,10c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S51.206,10,49,10z"></path></svg></button></div><div id="global-graph-outer"><div id="global-graph-container" data-cfg="{&quot;drag&quot;:true,&quot;zoom&quot;:true,&quot;depth&quot;:-1,&quot;scale&quot;:0.9,&quot;repelForce&quot;:0.5,&quot;centerForce&quot;:0.3,&quot;linkDistance&quot;:30,&quot;fontSize&quot;:0.6,&quot;opacityScale&quot;:1,&quot;showTags&quot;:true,&quot;removeTags&quot;:[],&quot;focusOnHover&quot;:true}"></div></div></div><div class="backlinks"><h3>Backlinks</h3><ul class="overflow"><li>No backlinks found</li></ul></div></div><footer class><p>Created with <a href="https://quartz.jzhao.xyz/">Quartz v4.4.0</a> © 2024</p><ul><li><a href="https://github.com/jackyzha0/quartz">GitHub</a></li><li><a href="https://discord.gg/cRFFHYye7t">Discord Community</a></li></ul></footer></div></div></body><script type="application/javascript">function c(){let t=this.parentElement;t.classList.toggle("is-collapsed");let l=t.classList.contains("is-collapsed")?this.scrollHeight:t.scrollHeight;t.style.maxHeight=l+"px";let o=t,e=t.parentElement;for(;e;){if(!e.classList.contains("callout"))return;let n=e.classList.contains("is-collapsed")?e.scrollHeight:e.scrollHeight+o.scrollHeight;e.style.maxHeight=n+"px",o=e,e=e.parentElement}}function i(){let t=document.getElementsByClassName("callout is-collapsible");for(let s of t){let l=s.firstElementChild;if(l){l.addEventListener("click",c),window.addCleanup(()=>l.removeEventListener("click",c));let e=s.classList.contains("is-collapsed")?l.scrollHeight:s.scrollHeight;s.style.maxHeight=e+"px"}}}document.addEventListener("nav",i);window.addEventListener("resize",i);
</script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/copy-tex.min.js" type="application/javascript"></script><script src="./postscript.js" type="module"></script></html>