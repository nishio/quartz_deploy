<!DOCTYPE html>
<html lang="en"><head><title>Regroup v2 review</title><meta charset="utf-8"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com"/><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=IBM Plex Mono&amp;family=Schibsted Grotesk:wght@400;700&amp;family=Source Sans Pro:ital,wght@0,400;0,600;1,400;1,600&amp;display=swap"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="og:site_name" content="ü™¥ Quartz 4.0"/><meta property="og:title" content="Regroup v2 review"/><meta property="og:type" content="website"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="Regroup v2 review"/><meta name="twitter:description" content="Assuming that the current Regroup code is to be discarded and rebuilt, a look back is needed before rebuilding. K: The good part P: Problems, what didn‚Äôt work T: Next Action P: Did not write the test from the beginning It was a project that was difficult to test because it was difficult to write tests in GUI, and because it used Canvas, DOM emulation did not work, but the lack of testing made it easier to break the project from a certain scale."/><meta property="og:description" content="Assuming that the current Regroup code is to be discarded and rebuilt, a look back is needed before rebuilding. K: The good part P: Problems, what didn‚Äôt work T: Next Action P: Did not write the test from the beginning It was a project that was difficult to test because it was difficult to write tests in GUI, and because it used Canvas, DOM emulation did not work, but the lack of testing made it easier to break the project from a certain scale."/><meta property="og:image:type" content="image/webp"/><meta property="og:image:alt" content="Assuming that the current Regroup code is to be discarded and rebuilt, a look back is needed before rebuilding. K: The good part P: Problems, what didn‚Äôt work T: Next Action P: Did not write the test from the beginning It was a project that was difficult to test because it was difficult to write tests in GUI, and because it used Canvas, DOM emulation did not work, but the lack of testing made it easier to break the project from a certain scale."/><meta property="og:image:width" content="1200"/><meta property="og:image:height" content="630"/><meta property="og:width" content="1200"/><meta property="og:height" content="630"/><meta property="og:image:url" content="https://quartz.jzhao.xyz/static/og-image.png"/><meta name="twitter:image" content="https://quartz.jzhao.xyz/static/og-image.png"/><meta property="og:image" content="https://quartz.jzhao.xyz/static/og-image.png"/><meta property="twitter:domain" content="quartz.jzhao.xyz"/><meta property="og:url" content="https:/quartz.jzhao.xyz/Regroup-v2-review"/><meta property="twitter:url" content="https:/quartz.jzhao.xyz/Regroup-v2-review"/><link rel="icon" href="./static/icon.png"/><meta name="description" content="Assuming that the current Regroup code is to be discarded and rebuilt, a look back is needed before rebuilding. K: The good part P: Problems, what didn‚Äôt work T: Next Action P: Did not write the test from the beginning It was a project that was difficult to test because it was difficult to write tests in GUI, and because it used Canvas, DOM emulation did not work, but the lack of testing made it easier to break the project from a certain scale."/><meta name="generator" content="Quartz"/><link href="./index.css" rel="stylesheet" type="text/css" spa-preserve/><link href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" rel="stylesheet" type="text/css" spa-preserve/><script src="./prescript.js" type="application/javascript" spa-preserve></script><script type="application/javascript" spa-preserve>const fetchData = fetch("./static/contentIndex.json").then(data => data.json())</script></head><body data-slug="Regroup-v2-review"><div id="quartz-root" class="page"><div id="quartz-body"><div class="left sidebar"><h2 class="page-title"><a href=".">ü™¥ Quartz 4.0</a></h2><div class="spacer mobile-only"></div><div class="search"><button class="search-button" id="search-button"><p>Search</p><svg role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title>Search</title><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"></path><circle cx="8" cy="8" r="7"></circle></g></svg></button><div id="search-container"><div id="search-space"><input autocomplete="off" id="search-bar" name="search" type="text" aria-label="Search for something" placeholder="Search for something"/><div id="search-layout" data-preview="true"></div></div></div></div><button class="darkmode" id="darkmode"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="dayIcon" x="0px" y="0px" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35" xml:space="preserve" aria-label="Dark mode"><title>Dark mode</title><path d="M6,17.5C6,16.672,5.328,16,4.5,16h-3C0.672,16,0,16.672,0,17.5    S0.672,19,1.5,19h3C5.328,19,6,18.328,6,17.5z M7.5,26c-0.414,0-0.789,0.168-1.061,0.439l-2,2C4.168,28.711,4,29.086,4,29.5    C4,30.328,4.671,31,5.5,31c0.414,0,0.789-0.168,1.06-0.44l2-2C8.832,28.289,9,27.914,9,27.5C9,26.672,8.329,26,7.5,26z M17.5,6    C18.329,6,19,5.328,19,4.5v-3C19,0.672,18.329,0,17.5,0S16,0.672,16,1.5v3C16,5.328,16.671,6,17.5,6z M27.5,9    c0.414,0,0.789-0.168,1.06-0.439l2-2C30.832,6.289,31,5.914,31,5.5C31,4.672,30.329,4,29.5,4c-0.414,0-0.789,0.168-1.061,0.44    l-2,2C26.168,6.711,26,7.086,26,7.5C26,8.328,26.671,9,27.5,9z M6.439,8.561C6.711,8.832,7.086,9,7.5,9C8.328,9,9,8.328,9,7.5    c0-0.414-0.168-0.789-0.439-1.061l-2-2C6.289,4.168,5.914,4,5.5,4C4.672,4,4,4.672,4,5.5c0,0.414,0.168,0.789,0.439,1.06    L6.439,8.561z M33.5,16h-3c-0.828,0-1.5,0.672-1.5,1.5s0.672,1.5,1.5,1.5h3c0.828,0,1.5-0.672,1.5-1.5S34.328,16,33.5,16z     M28.561,26.439C28.289,26.168,27.914,26,27.5,26c-0.828,0-1.5,0.672-1.5,1.5c0,0.414,0.168,0.789,0.439,1.06l2,2    C28.711,30.832,29.086,31,29.5,31c0.828,0,1.5-0.672,1.5-1.5c0-0.414-0.168-0.789-0.439-1.061L28.561,26.439z M17.5,29    c-0.829,0-1.5,0.672-1.5,1.5v3c0,0.828,0.671,1.5,1.5,1.5s1.5-0.672,1.5-1.5v-3C19,29.672,18.329,29,17.5,29z M17.5,7    C11.71,7,7,11.71,7,17.5S11.71,28,17.5,28S28,23.29,28,17.5S23.29,7,17.5,7z M17.5,25c-4.136,0-7.5-3.364-7.5-7.5    c0-4.136,3.364-7.5,7.5-7.5c4.136,0,7.5,3.364,7.5,7.5C25,21.636,21.636,25,17.5,25z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="nightIcon" x="0px" y="0px" viewBox="0 0 100 100" style="enable-background:new 0 0 100 100" xml:space="preserve" aria-label="Light mode"><title>Light mode</title><path d="M96.76,66.458c-0.853-0.852-2.15-1.064-3.23-0.534c-6.063,2.991-12.858,4.571-19.655,4.571  C62.022,70.495,50.88,65.88,42.5,57.5C29.043,44.043,25.658,23.536,34.076,6.47c0.532-1.08,0.318-2.379-0.534-3.23  c-0.851-0.852-2.15-1.064-3.23-0.534c-4.918,2.427-9.375,5.619-13.246,9.491c-9.447,9.447-14.65,22.008-14.65,35.369  c0,13.36,5.203,25.921,14.65,35.368s22.008,14.65,35.368,14.65c13.361,0,25.921-5.203,35.369-14.65  c3.872-3.871,7.064-8.328,9.491-13.246C97.826,68.608,97.611,67.309,96.76,66.458z"></path></svg></button></div><div class="center"><div class="page-header"><div class="popover-hint"><nav class="breadcrumb-container" aria-label="breadcrumbs"><div class="breadcrumb-element"><a href="./">Home</a><p> ‚ùØ </p></div><div class="breadcrumb-element"><a href>Regroup v2 review</a></div></nav><h1 class="article-title">Regroup v2 review</h1><p show-comma="true" class="content-meta"><span>Jun 12, 2021</span><span>5 min read</span></p></div></div><article class="popover-hint"><p>Assuming that the current Regroup code is to be discarded and rebuilt, a look back is needed before rebuilding.
K: The good part
P: Problems, what didn‚Äôt work
T: Next Action</p>
<p>P: Did not write the test from the beginning</p>
<ul>
<li>It was a project that was difficult to test because it was difficult to write tests in GUI, and because it used Canvas, DOM emulation did not work, but the lack of testing made it easier to break the project from a certain scale.</li>
<li>I started testing with <a href="./jest-electron" class="internal" data-slug="jest-electron">jest-electron</a> after it became too fragile, but the difficulty increased because I started testing after it became too complicated.</li>
</ul>
<p>P: I‚Äôve required Paper.js</p>
<ul>
<li>I didn‚Äôt have enough understanding of the module system because I was using TypeScript for the first time in earnest, and this way of doing things was PAPER was ANY
<ul>
<li><a href="./I-spent-two-days-eradicating-ANY." class="internal alias" data-slug="I-spent-two-days-eradicating-ANY.">I spent two days eradicating ANY.</a> It was discovered in</li>
</ul>
</li>
<li>If you‚Äôre going to rebuild, do it from the beginning in the style of ‚Äúallow no more than a very localized version of any‚Äù.</li>
</ul>
<p>P: I used ToolEvent in paper.js</p>
<ul>
<li>This is a framework that assumes that the handling of mouse events is neatly switched by the global state of ‚Äútool‚Äù.
<ul>
<li>Realistically, it isn‚Äôt.</li>
<li>Especially on the iPad, multi-touch gestures are handled in a separate and independent event handler, which has become a source of troublesome problems.</li>
<li>For example, if a hand inadvertently touches the screen while writing with a pen, multi-touch occurs. How to deal with such a situation?</li>
</ul>
</li>
</ul>
<p>Undo Design</p>
<ul>
<li>From very early on, we thought that Undo should be there.</li>
<li>Therefore, we designed React‚Äôs state update hooks to manage Undo/Redo.</li>
<li>If you move one sticky, it will update its status and the Undo list will grow.</li>
<li>This didn‚Äôt work.
<ul>
<li>When there are more functions to move multiple stickies at once, reusing a function to move one sticky at a time would result in Undo for each sticky.</li>
<li>Multiple piece moves are tied together to update the state at one time.</li>
<li>When stickies and paths are created, if you select them and move them around‚Ä¶complication!</li>
<li>I tried to change it later to a form that explicitly takes snapshuts, but it breaks all over the place.</li>
</ul>
</li>
<li>Undo broke and I used it in that state for a while, but there are not many cases where Undo is needed.
<ul>
<li>I misspelled it with a pen and want to put it back.</li>
<li>I want to put it back because I put it down in a weird place on a multi-piece move.</li>
</ul>
</li>
<li>If you miss moving one sticky, you usually just move it further.
<ul>
<li>Undo of one sticky note was a ‚Äúfeature that customers did not ask for‚Äù.</li>
</ul>
</li>
</ul>
<p>About Network Synchronization</p>
<ul>
<li>Casual Synchronization with Firestore</li>
<li>You can edit it as long as you are looking at the same URL.
<ul>
<li>A convenient system that can be fiddled with on a PC, smartphone, or tablet for a single person‚Äôs use.
<ul>
<li>Can be shared via Handoff or AirDrop.</li>
</ul>
</li>
<li>But basically, it‚Äôs overwritten with the information that arrived at the server, so it‚Äôs easily broken if multiple people edit it at the same time.</li>
</ul>
</li>
<li>Users may not want to edit in the first place
<ul>
<li>I‚Äôm afraid of accidentally breaking it.‚Äù</li>
<li>If you make an ‚Äúedit request‚Äù in the default non-editing mode, and the person who has editing rights now passes it on, there should always be one editor.</li>
<li>The mere viewer was also supposed to open and close the bundled sticky notes.</li>
<li>Isn‚Äôt Regroup‚Äôs map basically for others to see in the first place?
<ul>
<li>Does this mean that the ‚Äúthought process‚Äù is not in an appropriate form to show to others as it is, and that we have to do one more step?</li>
<li>Not sure if that ‚Äúclean-up‚Äù process should be able to be done on Regroup.</li>
<li>There‚Äôs also the theory that they‚Äôre not going to do the ‚Äúlet‚Äôs get a clean copy and show it to you‚Äù thing anyway.</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Every time I update it, I erase the canvas and redraw it.</p>
<ul>
<li>Would it be faster if I only update what has changed? This should be verified.</li>
</ul>
<p>On the iPad, I‚Äôm converting to an image and zooming, on the PC, I‚Äôm changing the zoom on the wheel event.</p>
<ul>
<li>Due to the wheel event not having an ‚Äúend event‚Äù unlike a swipe.</li>
<li>This would be a rather large effect of the drawing delay.</li>
</ul>
<p>Need a pen?</p>
<ul>
<li>
<p>Hmmm, not essential, but it is beneficial to be able to easily add things that are difficult to express with just the placement of stickies</p>
</li>
<li>
<p>Was it right to make the entire surface Canvas with pen input as the basic premise?</p>
<ul>
<li>This is slightly iffy.</li>
<li>When used as a normal handwritten note application‚Ä¶
<ul>
<li>It‚Äôs indeed a browser app, so the behavior is heavy.</li>
<li>It‚Äôs not explicitly stated, but Firestore‚Äôs stuck on the document space limit.</li>
</ul>
</li>
<li>You could make the stickies as DOM, and only the handwritten lines could be Canvas or SVG for each group.
<ul>
<li>Advantages of this method:.
<ul>
<li>Maybe you can find the sticky using your browser‚Äôs standard search.</li>
<li>Reduces ‚Äúdifficult to test because of Canvas‚Äù problems</li>
<li>Can you let React handle the diff updates?</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Full canvas is needed for lasso selection, etc.</p>
</li>
<li>
<p><a href="./Should-we-rebuild-or-not&quot;-is-a-false-choice." class="internal alias" data-slug="Should-we-rebuild-or-not&quot;-is-a-false-choice.">Should we rebuild or not?‚Äù is a false choice.</a></p>
</li>
</ul>
<hr/>
<p>This page is auto-translated from [/nishio/Regroup v2ÊåØ„ÇäËøî„Çä](<a href="https://scrapbox.io/nishio/Regroup" class="external">https://scrapbox.io/nishio/Regroup<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a> v2ÊåØ„ÇäËøî„Çä) using DeepL. If you looks something interesting but the auto-translated English is not good enough to understand it, feel free to let me know at <a href="https://twitter.com/nishio_en" class="external">@nishio_en<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a>. I‚Äôm very happy to spread my thought to non-Japanese readers.</p></article><hr/><div class="page-footer"></div></div><div class="right sidebar"><div class="graph"><h3>Graph View</h3><div class="graph-outer"><div id="graph-container" data-cfg="{&quot;drag&quot;:true,&quot;zoom&quot;:true,&quot;depth&quot;:1,&quot;scale&quot;:1.1,&quot;repelForce&quot;:0.5,&quot;centerForce&quot;:0.3,&quot;linkDistance&quot;:30,&quot;fontSize&quot;:0.6,&quot;opacityScale&quot;:1,&quot;showTags&quot;:true,&quot;removeTags&quot;:[],&quot;focusOnHover&quot;:false}"></div><button id="global-graph-icon" aria-label="Global Graph"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 55 55" fill="currentColor" xml:space="preserve"><path d="M49,0c-3.309,0-6,2.691-6,6c0,1.035,0.263,2.009,0.726,2.86l-9.829,9.829C32.542,17.634,30.846,17,29,17
                s-3.542,0.634-4.898,1.688l-7.669-7.669C16.785,10.424,17,9.74,17,9c0-2.206-1.794-4-4-4S9,6.794,9,9s1.794,4,4,4
                c0.74,0,1.424-0.215,2.019-0.567l7.669,7.669C21.634,21.458,21,23.154,21,25s0.634,3.542,1.688,4.897L10.024,42.562
                C8.958,41.595,7.549,41,6,41c-3.309,0-6,2.691-6,6s2.691,6,6,6s6-2.691,6-6c0-1.035-0.263-2.009-0.726-2.86l12.829-12.829
                c1.106,0.86,2.44,1.436,3.898,1.619v10.16c-2.833,0.478-5,2.942-5,5.91c0,3.309,2.691,6,6,6s6-2.691,6-6c0-2.967-2.167-5.431-5-5.91
                v-10.16c1.458-0.183,2.792-0.759,3.898-1.619l7.669,7.669C41.215,39.576,41,40.26,41,41c0,2.206,1.794,4,4,4s4-1.794,4-4
                s-1.794-4-4-4c-0.74,0-1.424,0.215-2.019,0.567l-7.669-7.669C36.366,28.542,37,26.846,37,25s-0.634-3.542-1.688-4.897l9.665-9.665
                C46.042,11.405,47.451,12,49,12c3.309,0,6-2.691,6-6S52.309,0,49,0z M11,9c0-1.103,0.897-2,2-2s2,0.897,2,2s-0.897,2-2,2
                S11,10.103,11,9z M6,51c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S8.206,51,6,51z M33,49c0,2.206-1.794,4-4,4s-4-1.794-4-4
                s1.794-4,4-4S33,46.794,33,49z M29,31c-3.309,0-6-2.691-6-6s2.691-6,6-6s6,2.691,6,6S32.309,31,29,31z M47,41c0,1.103-0.897,2-2,2
                s-2-0.897-2-2s0.897-2,2-2S47,39.897,47,41z M49,10c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S51.206,10,49,10z"></path></svg></button></div><div id="global-graph-outer"><div id="global-graph-container" data-cfg="{&quot;drag&quot;:true,&quot;zoom&quot;:true,&quot;depth&quot;:-1,&quot;scale&quot;:0.9,&quot;repelForce&quot;:0.5,&quot;centerForce&quot;:0.3,&quot;linkDistance&quot;:30,&quot;fontSize&quot;:0.6,&quot;opacityScale&quot;:1,&quot;showTags&quot;:true,&quot;removeTags&quot;:[],&quot;focusOnHover&quot;:true}"></div></div></div><div class="backlinks"><h3>Backlinks</h3><ul class="overflow"><li><a href="./History" class="internal">History</a></li><li><a href="./Regroup-to-Movidea" class="internal">Regroup to Movidea</a></li></ul></div></div><footer class><p>Created with <a href="https://quartz.jzhao.xyz/">Quartz v4.4.0</a> ¬© 2024</p><ul><li><a href="https://github.com/jackyzha0/quartz">GitHub</a></li><li><a href="https://discord.gg/cRFFHYye7t">Discord Community</a></li></ul></footer></div></div></body><script type="application/javascript">function c(){let t=this.parentElement;t.classList.toggle("is-collapsed");let l=t.classList.contains("is-collapsed")?this.scrollHeight:t.scrollHeight;t.style.maxHeight=l+"px";let o=t,e=t.parentElement;for(;e;){if(!e.classList.contains("callout"))return;let n=e.classList.contains("is-collapsed")?e.scrollHeight:e.scrollHeight+o.scrollHeight;e.style.maxHeight=n+"px",o=e,e=e.parentElement}}function i(){let t=document.getElementsByClassName("callout is-collapsible");for(let s of t){let l=s.firstElementChild;if(l){l.addEventListener("click",c),window.addCleanup(()=>l.removeEventListener("click",c));let e=s.classList.contains("is-collapsed")?l.scrollHeight:s.scrollHeight;s.style.maxHeight=e+"px"}}}document.addEventListener("nav",i);window.addEventListener("resize",i);
</script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/copy-tex.min.js" type="application/javascript"></script><script src="./postscript.js" type="module"></script></html>