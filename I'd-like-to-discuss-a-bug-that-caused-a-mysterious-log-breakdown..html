<!DOCTYPE html>
<html lang="en"><head><title>I'd like to discuss a bug that caused a mysterious log breakdown.</title><meta charset="utf-8"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com"/><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=IBM Plex Mono&amp;family=Schibsted Grotesk:wght@400;700&amp;family=Source Sans Pro:ital,wght@0,400;0,600;1,400;1,600&amp;display=swap"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="og:site_name" content="🪴 Quartz 4.0"/><meta property="og:title" content="I'd like to discuss a bug that caused a mysterious log breakdown."/><meta property="og:type" content="website"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="I'd like to discuss a bug that caused a mysterious log breakdown."/><meta name="twitter:description" content="summary I had a bug that I didn’t understand, so I asked for help with a problem. The initially perceived “log breakdown” turned out to be an incorrect perception of the phenomenon."/><meta property="og:description" content="summary I had a bug that I didn’t understand, so I asked for help with a problem. The initially perceived “log breakdown” turned out to be an incorrect perception of the phenomenon."/><meta property="og:image:type" content="image/webp"/><meta property="og:image:alt" content="summary I had a bug that I didn’t understand, so I asked for help with a problem. The initially perceived “log breakdown” turned out to be an incorrect perception of the phenomenon."/><meta property="og:image:width" content="1200"/><meta property="og:image:height" content="630"/><meta property="og:width" content="1200"/><meta property="og:height" content="630"/><meta property="og:image:url" content="https://quartz.jzhao.xyz/static/og-image.png"/><meta name="twitter:image" content="https://quartz.jzhao.xyz/static/og-image.png"/><meta property="og:image" content="https://quartz.jzhao.xyz/static/og-image.png"/><meta property="twitter:domain" content="quartz.jzhao.xyz"/><meta property="og:url" content="https:/quartz.jzhao.xyz/I'd-like-to-discuss-a-bug-that-caused-a-mysterious-log-breakdown."/><meta property="twitter:url" content="https:/quartz.jzhao.xyz/I'd-like-to-discuss-a-bug-that-caused-a-mysterious-log-breakdown."/><link rel="icon" href="./static/icon.png"/><meta name="description" content="summary I had a bug that I didn’t understand, so I asked for help with a problem. The initially perceived “log breakdown” turned out to be an incorrect perception of the phenomenon."/><meta name="generator" content="Quartz"/><link href="./index.css" rel="stylesheet" type="text/css" spa-preserve/><link href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" rel="stylesheet" type="text/css" spa-preserve/><script src="./prescript.js" type="application/javascript" spa-preserve></script><script type="application/javascript" spa-preserve>const fetchData = fetch("./static/contentIndex.json").then(data => data.json())</script></head><body data-slug="I'd-like-to-discuss-a-bug-that-caused-a-mysterious-log-breakdown."><div id="quartz-root" class="page"><div id="quartz-body"><div class="left sidebar"><h2 class="page-title"><a href=".">🪴 Quartz 4.0</a></h2><div class="spacer mobile-only"></div><div class="search"><button class="search-button" id="search-button"><p>Search</p><svg role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title>Search</title><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"></path><circle cx="8" cy="8" r="7"></circle></g></svg></button><div id="search-container"><div id="search-space"><input autocomplete="off" id="search-bar" name="search" type="text" aria-label="Search for something" placeholder="Search for something"/><div id="search-layout" data-preview="true"></div></div></div></div><button class="darkmode" id="darkmode"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="dayIcon" x="0px" y="0px" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35" xml:space="preserve" aria-label="Dark mode"><title>Dark mode</title><path d="M6,17.5C6,16.672,5.328,16,4.5,16h-3C0.672,16,0,16.672,0,17.5    S0.672,19,1.5,19h3C5.328,19,6,18.328,6,17.5z M7.5,26c-0.414,0-0.789,0.168-1.061,0.439l-2,2C4.168,28.711,4,29.086,4,29.5    C4,30.328,4.671,31,5.5,31c0.414,0,0.789-0.168,1.06-0.44l2-2C8.832,28.289,9,27.914,9,27.5C9,26.672,8.329,26,7.5,26z M17.5,6    C18.329,6,19,5.328,19,4.5v-3C19,0.672,18.329,0,17.5,0S16,0.672,16,1.5v3C16,5.328,16.671,6,17.5,6z M27.5,9    c0.414,0,0.789-0.168,1.06-0.439l2-2C30.832,6.289,31,5.914,31,5.5C31,4.672,30.329,4,29.5,4c-0.414,0-0.789,0.168-1.061,0.44    l-2,2C26.168,6.711,26,7.086,26,7.5C26,8.328,26.671,9,27.5,9z M6.439,8.561C6.711,8.832,7.086,9,7.5,9C8.328,9,9,8.328,9,7.5    c0-0.414-0.168-0.789-0.439-1.061l-2-2C6.289,4.168,5.914,4,5.5,4C4.672,4,4,4.672,4,5.5c0,0.414,0.168,0.789,0.439,1.06    L6.439,8.561z M33.5,16h-3c-0.828,0-1.5,0.672-1.5,1.5s0.672,1.5,1.5,1.5h3c0.828,0,1.5-0.672,1.5-1.5S34.328,16,33.5,16z     M28.561,26.439C28.289,26.168,27.914,26,27.5,26c-0.828,0-1.5,0.672-1.5,1.5c0,0.414,0.168,0.789,0.439,1.06l2,2    C28.711,30.832,29.086,31,29.5,31c0.828,0,1.5-0.672,1.5-1.5c0-0.414-0.168-0.789-0.439-1.061L28.561,26.439z M17.5,29    c-0.829,0-1.5,0.672-1.5,1.5v3c0,0.828,0.671,1.5,1.5,1.5s1.5-0.672,1.5-1.5v-3C19,29.672,18.329,29,17.5,29z M17.5,7    C11.71,7,7,11.71,7,17.5S11.71,28,17.5,28S28,23.29,28,17.5S23.29,7,17.5,7z M17.5,25c-4.136,0-7.5-3.364-7.5-7.5    c0-4.136,3.364-7.5,7.5-7.5c4.136,0,7.5,3.364,7.5,7.5C25,21.636,21.636,25,17.5,25z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="nightIcon" x="0px" y="0px" viewBox="0 0 100 100" style="enable-background:new 0 0 100 100" xml:space="preserve" aria-label="Light mode"><title>Light mode</title><path d="M96.76,66.458c-0.853-0.852-2.15-1.064-3.23-0.534c-6.063,2.991-12.858,4.571-19.655,4.571  C62.022,70.495,50.88,65.88,42.5,57.5C29.043,44.043,25.658,23.536,34.076,6.47c0.532-1.08,0.318-2.379-0.534-3.23  c-0.851-0.852-2.15-1.064-3.23-0.534c-4.918,2.427-9.375,5.619-13.246,9.491c-9.447,9.447-14.65,22.008-14.65,35.369  c0,13.36,5.203,25.921,14.65,35.368s22.008,14.65,35.368,14.65c13.361,0,25.921-5.203,35.369-14.65  c3.872-3.871,7.064-8.328,9.491-13.246C97.826,68.608,97.611,67.309,96.76,66.458z"></path></svg></button></div><div class="center"><div class="page-header"><div class="popover-hint"><nav class="breadcrumb-container" aria-label="breadcrumbs"><div class="breadcrumb-element"><a href="./">Home</a><p> ❯ </p></div><div class="breadcrumb-element"><a href>I'd like to discuss a bug that caused a mysterious log breakdown.</a></div></nav><h1 class="article-title">I'd like to discuss a bug that caused a mysterious log breakdown.</h1><p show-comma="true" class="content-meta"><span>Mar 28, 2021</span><span>5 min read</span></p></div></div><article class="popover-hint"><p>summary</p>
<ul>
<li>I had a bug that I didn’t understand, so I asked for help with a problem.</li>
<li>The initially perceived “log breakdown” turned out to be an incorrect perception of the phenomenon.
<ul>
<li>Correct: “The log splits into two conversations.”</li>
</ul>
</li>
<li>It’s a relief to know that the logs haven’t been lost.</li>
</ul>
<p><img src="https://scrapbox.io/api/pages/nishio/nisbot/icon" alt="nisbot.icon" height="19.5"/>What would you like to see happen in this conversation?
<img src="https://scrapbox.io/api/pages/nishio/nishio/icon" alt="nishio.icon" height="19.5"/>I’d like to discuss a bug that caused a mysterious log breakdown.
<img src="https://scrapbox.io/api/pages/nishio/nisbot/icon" alt="nisbot.icon" height="19.5"/>What kind of “bug” is this “bug”?
<img src="https://scrapbox.io/api/pages/nishio/nishio/icon" alt="nishio.icon" height="19.5"/>The first few lines of the log were lost. Even the data stored on the server lost the beginning of the log.
<img src="https://scrapbox.io/api/pages/nishio/nisbot/icon" alt="nisbot.icon" height="19.5"/>What kind of “log” is that “log”?
<img src="https://scrapbox.io/api/pages/nishio/nishio/icon" alt="nishio.icon" height="19.5"/>Conversation Log. A list of what the user typed into the chat and what the bot responded to.
<img src="https://scrapbox.io/api/pages/nishio/nisbot/icon" alt="nisbot.icon" height="19.5"/>Is there anything else about that “log”?
<img src="https://scrapbox.io/api/pages/nishio/nishio/icon" alt="nishio.icon" height="19.5"/>In the first place, the server is supposed to send a single line of statements to the server, and the server side is supposed to do the postscript, so it’s puzzling why it breaks off in the middle of the statement.
<img src="https://scrapbox.io/api/pages/nishio/nisbot/icon" alt="nisbot.icon" height="19.5"/></p>
<ul>
<li>
<blockquote>
<p>Conversation logs. A list of what the user typed into the chat and what the bot responded to.</p>
</blockquote>
</li>
<li>Where is this “log” located?
<img src="https://scrapbox.io/api/pages/nishio/nishio/icon" alt="nishio.icon" height="19.5"/>on the server.
<img src="https://scrapbox.io/api/pages/nishio/nisbot/icon" alt="nisbot.icon" height="19.5"/>What kind of “server” is this “server”?
<img src="https://scrapbox.io/api/pages/nishio/nishio/icon" alt="nishio.icon" height="19.5"/>Receive a string on Heroku and return a reply response. The status is stored in Firestore.
<img src="https://scrapbox.io/api/pages/nishio/nisbot/icon" alt="nisbot.icon" height="19.5"/>What kind of “save” is that “save”?
<img src="https://scrapbox.io/api/pages/nishio/nishio/icon" alt="nishio.icon" height="19.5"/>The KVS is keyed to the talk ID, and the internal state necessary to continue the conversation is converted to JSON and stored there. JSON is the historical background, and when actually used, it is necessary to convert it into a form that can be entered into the Firestore before saving it.
<img src="https://scrapbox.io/api/pages/nishio/nisbot/icon" alt="nisbot.icon" height="19.5"/>What is it that you value?
<img src="https://scrapbox.io/api/pages/nishio/nishio/icon" alt="nishio.icon" height="19.5"/>I would like to see the bugs worked out. Losing logs is a loss, and I can’t use it safely if I think it might be lost. I’ve tried a few quick and suspicious operations, but I can’t reproduce them and I’m having a hard time keeping my head above water.
<img src="https://scrapbox.io/api/pages/nishio/nisbot/icon" alt="nisbot.icon" height="19.5"/>Where is that “log” located?
<img src="https://scrapbox.io/api/pages/nishio/nishio/icon" alt="nishio.icon" height="19.5"/>Firestore.
<img src="https://scrapbox.io/api/pages/nishio/nisbot/icon" alt="nisbot.icon" height="19.5"/>
</li>
<li>
<blockquote>
<p>I would like to see the bug resolved. Losing logs is a loss, and I can’t use it with confidence if I think it might be lost. I’ve tried a few quick and suspicious operations, but I can’t reproduce them, and I’m having a hard time keeping my head above water.</p>
</blockquote>
</li>
<li>What does this “log” look like?
<img src="https://scrapbox.io/api/pages/nishio/nishio/icon" alt="nishio.icon" height="19.5"/>Files to be appended. If the log disappears, you’d think it was overwritten, but it’s inexplicable that it disappears because it should have been loaded, added, and written back in the first place.
<img src="https://scrapbox.io/api/pages/nishio/nisbot/icon" alt="nisbot.icon" height="19.5"/>Where do these “logs” come from?
<img src="https://scrapbox.io/api/pages/nishio/nishio/icon" alt="nishio.icon" height="19.5"/>Let’s see, the feature that I think is suspicious this time is the “open and continue past conversations” feature that I recently added, and I was using it all the time when the logs actually disappeared. When I used this feature, I first accessed Firestore with the conversation ID in the browser’s IndexedDB to retrieve the past logs and display them.
<img src="https://scrapbox.io/api/pages/nishio/nisbot/icon" alt="nisbot.icon" height="19.5"/>How do you know its “log”?
<img src="https://scrapbox.io/api/pages/nishio/nishio/icon" alt="nishio.icon" height="19.5"/>I’ll send the conversation ID to Firestore and say, “Give me the log of this conversation.”
<img src="https://scrapbox.io/api/pages/nishio/nisbot/icon" alt="nisbot.icon" height="19.5"/>What would you like to see happen with respect to that “log”?
<img src="https://scrapbox.io/api/pages/nishio/nishio/icon" alt="nishio.icon" height="19.5"/>I wish it would not disappear, or at least know how to reproduce the disappearing phenomenon. If you can’t reproduce it, you can’t debug it.
<img src="https://scrapbox.io/api/pages/nishio/nisbot/icon" alt="nisbot.icon" height="19.5"/>What needs to happen to the “log” for that to happen?
<img src="https://scrapbox.io/api/pages/nishio/nishio/icon" alt="nishio.icon" height="19.5"/>I don’t know!
<img src="https://scrapbox.io/api/pages/nishio/nisbot/icon" alt="nisbot.icon" height="19.5"/>
</li>
<li>
<blockquote>
<p>I’ll send the conversation ID to Firestore and say, “Give me the log of this conversation.”</p>
</blockquote>
</li>
<li>What kind of “Firestore” is this “Firestore”?
<img src="https://scrapbox.io/api/pages/nishio/nishio/icon" alt="nishio.icon" height="19.5"/>Just a KVS on a server
<img src="https://scrapbox.io/api/pages/nishio/nisbot/icon" alt="nisbot.icon" height="19.5"/>Is there anything else you can tell us about that “server”?
<img src="https://scrapbox.io/api/pages/nishio/nishio/icon" alt="nishio.icon" height="19.5"/>I have a script that downloads the values on the server locally to make it easier to investigate, and I did see that the beginning of the log in question was broken using that, but then a few other things were downloaded. I should also see what kind of data those are.
<img src="https://scrapbox.io/api/pages/nishio/nisbot/icon" alt="nisbot.icon" height="19.5"/>How do you know its “server”?
<img src="https://scrapbox.io/api/pages/nishio/nishio/icon" alt="nishio.icon" height="19.5"/>That’s the best way to know what the servers are up to.
<img src="https://scrapbox.io/api/pages/nishio/nisbot/icon" alt="nisbot.icon" height="19.5"/>Where is this “server” located?
<img src="https://scrapbox.io/api/pages/nishio/nishio/icon" alt="nishio.icon" height="19.5"/>I’m going to go observe a local copy.
<img src="https://scrapbox.io/api/pages/nishio/nisbot/icon" alt="nisbot.icon" height="19.5"/>
</li>
<li>
<blockquote>
<p>That’s the best way to know what’s going on with the servers.</p>
</blockquote>
</li>
<li>What do you hope will happen regarding this “server”?
<img src="https://scrapbox.io/api/pages/nishio/nishio/icon" alt="nishio.icon" height="19.5"/>Okay, the log isn’t missing, it’s split into two conversations.
<img src="https://scrapbox.io/api/pages/nishio/nisbot/icon" alt="nisbot.icon" height="19.5"/>What kind of “conversation” is that “conversation”?
<img src="https://scrapbox.io/api/pages/nishio/nishio/icon" alt="nishio.icon" height="19.5"/>In other words, I thought I was having one conversation, but some kind of malfunction or something caused me to start another new conversation in the middle of the first one.
<img src="https://scrapbox.io/api/pages/nishio/nisbot/icon" alt="nisbot.icon" height="19.5"/>Is there anything else about that “conversation”?
<img src="https://scrapbox.io/api/pages/nishio/nishio/icon" alt="nishio.icon" height="19.5"/>I just looked at the list of past conversations saved in my browser, and sure enough, there were two conversations. I didn’t notice that, and I displayed the log at the time the second conversation ended, so only the log of the second half of the conversation was displayed, and I thought, “The first half is lost? I guess I misunderstood. I could see the log of the first half without any problem.
<img src="https://scrapbox.io/api/pages/nishio/nisbot/icon" alt="nisbot.icon" height="19.5"/>How do you know its a “conversation”?
<img src="https://scrapbox.io/api/pages/nishio/nishio/icon" alt="nishio.icon" height="19.5"/>Good thing I added the past conversation list feature. You can see it there.
<img src="https://scrapbox.io/api/pages/nishio/nisbot/icon" alt="nisbot.icon" height="19.5"/>What does that “conversation” sound like?
<img src="https://scrapbox.io/api/pages/nishio/nishio/icon" alt="nishio.icon" height="19.5"/>Unlike verbal conversations, which can be erased, I think it’s important to keep a log and be able to read it back later. So it’s a written image. That’s why I was so worried when I heard, “The log is gone? but I am relieved to know that it has not disappeared for the time being.
<img src="https://scrapbox.io/api/pages/nishio/nisbot/icon" alt="nisbot.icon" height="19.5"/>Where does this “conversation” come from?</li>
</ul>
<hr/>
<p>This page is auto-translated from <a href="https://scrapbox.io/nishio/%E8%AC%8E%E3%81%AE%E3%83%AD%E3%82%B0%E3%81%8C%E9%80%94%E5%88%87%E3%82%8C%E3%82%8B%E3%83%90%E3%82%B0%E3%81%8C%E8%B5%B7%E3%81%8D%E3%81%9F%E3%81%AE%E3%81%A7%E7%9B%B8%E8%AB%87%E3%81%97%E3%81%9F%E3%81%84" class="external">/nishio/謎のログが途切れるバグが起きたので相談したい<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a> using DeepL. If you looks something interesting but the auto-translated English is not good enough to understand it, feel free to let me know at <a href="https://twitter.com/nishio_en" class="external">@nishio_en<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a>. I’m very happy to spread my thought to non-Japanese readers.</p></article><hr/><div class="page-footer"></div></div><div class="right sidebar"><div class="graph"><h3>Graph View</h3><div class="graph-outer"><div id="graph-container" data-cfg="{&quot;drag&quot;:true,&quot;zoom&quot;:true,&quot;depth&quot;:1,&quot;scale&quot;:1.1,&quot;repelForce&quot;:0.5,&quot;centerForce&quot;:0.3,&quot;linkDistance&quot;:30,&quot;fontSize&quot;:0.6,&quot;opacityScale&quot;:1,&quot;showTags&quot;:true,&quot;removeTags&quot;:[],&quot;focusOnHover&quot;:false}"></div><button id="global-graph-icon" aria-label="Global Graph"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 55 55" fill="currentColor" xml:space="preserve"><path d="M49,0c-3.309,0-6,2.691-6,6c0,1.035,0.263,2.009,0.726,2.86l-9.829,9.829C32.542,17.634,30.846,17,29,17
                s-3.542,0.634-4.898,1.688l-7.669-7.669C16.785,10.424,17,9.74,17,9c0-2.206-1.794-4-4-4S9,6.794,9,9s1.794,4,4,4
                c0.74,0,1.424-0.215,2.019-0.567l7.669,7.669C21.634,21.458,21,23.154,21,25s0.634,3.542,1.688,4.897L10.024,42.562
                C8.958,41.595,7.549,41,6,41c-3.309,0-6,2.691-6,6s2.691,6,6,6s6-2.691,6-6c0-1.035-0.263-2.009-0.726-2.86l12.829-12.829
                c1.106,0.86,2.44,1.436,3.898,1.619v10.16c-2.833,0.478-5,2.942-5,5.91c0,3.309,2.691,6,6,6s6-2.691,6-6c0-2.967-2.167-5.431-5-5.91
                v-10.16c1.458-0.183,2.792-0.759,3.898-1.619l7.669,7.669C41.215,39.576,41,40.26,41,41c0,2.206,1.794,4,4,4s4-1.794,4-4
                s-1.794-4-4-4c-0.74,0-1.424,0.215-2.019,0.567l-7.669-7.669C36.366,28.542,37,26.846,37,25s-0.634-3.542-1.688-4.897l9.665-9.665
                C46.042,11.405,47.451,12,49,12c3.309,0,6-2.691,6-6S52.309,0,49,0z M11,9c0-1.103,0.897-2,2-2s2,0.897,2,2s-0.897,2-2,2
                S11,10.103,11,9z M6,51c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S8.206,51,6,51z M33,49c0,2.206-1.794,4-4,4s-4-1.794-4-4
                s1.794-4,4-4S33,46.794,33,49z M29,31c-3.309,0-6-2.691-6-6s2.691-6,6-6s6,2.691,6,6S32.309,31,29,31z M47,41c0,1.103-0.897,2-2,2
                s-2-0.897-2-2s0.897-2,2-2S47,39.897,47,41z M49,10c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S51.206,10,49,10z"></path></svg></button></div><div id="global-graph-outer"><div id="global-graph-container" data-cfg="{&quot;drag&quot;:true,&quot;zoom&quot;:true,&quot;depth&quot;:-1,&quot;scale&quot;:0.9,&quot;repelForce&quot;:0.5,&quot;centerForce&quot;:0.3,&quot;linkDistance&quot;:30,&quot;fontSize&quot;:0.6,&quot;opacityScale&quot;:1,&quot;showTags&quot;:true,&quot;removeTags&quot;:[],&quot;focusOnHover&quot;:true}"></div></div></div><div class="backlinks"><h3>Backlinks</h3><ul class="overflow"><li><a href="./Listening-Chat-System-Conversation-Log" class="internal">Listening Chat System Conversation Log</a></li><li><a href="./pKeicho" class="internal">pKeicho</a></li><li><a href="./pKeichobot" class="internal">pKeichobot</a></li></ul></div></div><footer class><p>Created with <a href="https://quartz.jzhao.xyz/">Quartz v4.4.0</a> © 2024</p><ul><li><a href="https://github.com/jackyzha0/quartz">GitHub</a></li><li><a href="https://discord.gg/cRFFHYye7t">Discord Community</a></li></ul></footer></div></div></body><script type="application/javascript">function c(){let t=this.parentElement;t.classList.toggle("is-collapsed");let l=t.classList.contains("is-collapsed")?this.scrollHeight:t.scrollHeight;t.style.maxHeight=l+"px";let o=t,e=t.parentElement;for(;e;){if(!e.classList.contains("callout"))return;let n=e.classList.contains("is-collapsed")?e.scrollHeight:e.scrollHeight+o.scrollHeight;e.style.maxHeight=n+"px",o=e,e=e.parentElement}}function i(){let t=document.getElementsByClassName("callout is-collapsible");for(let s of t){let l=s.firstElementChild;if(l){l.addEventListener("click",c),window.addCleanup(()=>l.removeEventListener("click",c));let e=s.classList.contains("is-collapsed")?l.scrollHeight:s.scrollHeight;s.style.maxHeight=e+"px"}}}document.addEventListener("nav",i);window.addEventListener("resize",i);
</script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/copy-tex.min.js" type="application/javascript"></script><script src="./postscript.js" type="module"></script></html>